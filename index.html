<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy Birthday!</title>
<style>
body {
  margin: 0;
  padding: 0;
  background: #ffe5e5;
  overflow: hidden;
  font-family: 'Arial', sans-serif;
  height: 100vh;
  position: relative;
}
#cake-container {
  position: absolute;
  top: 15%;
  left: 50%;
  transform: translateX(-50%);
  z-index: 5;
  transition: opacity 1.5s ease;
}
#cake {
  width: 250px;
}
.flame {
  position: absolute;
  top: -30px;
  left: 50%;
  transform: translateX(-50%);
  width: 35px;
  animation: flicker 0.2s infinite alternate;
}
@keyframes flicker {
  0% { opacity: 1; }
  100% { opacity: 0.8; }
}
#blow-btn {
  position: absolute;
  top: 60%;
  left: 50%;
  transform: translateX(-50%);
  padding: 15px 30px;
  font-size: 20px;
  cursor: pointer;
  border: none;
  background: #ff0066;
  color: white;
  border-radius: 10px;
  z-index: 15;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}
#blow-btn:hover {
  background: #ff3388;
}
.smoke {
  position: absolute;
  top: -50px;
  left: 50%;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: rgba(200,200,200,0.6);
  animation: smokeRise 2s forwards;
  z-index: 4;
}
@keyframes smokeRise {
  0% { transform: translateX(-50%) translateY(0) scale(0.5); opacity: 0.7; }
  100% { transform: translateX(-50%) translateY(-200px) scale(2); opacity: 0; }
}
.photo {
  position: absolute;
  top: 50%;
  left: 50%;
  max-width: 90vw;
  max-height: 90vh;
  object-fit: contain;
  transform: translate(-50%, -50%);
  opacity: 0;
  transition: opacity 2s ease;
  z-index: 3;
}
.confetti {
  position: absolute;
  width: 12px;
  height: 12px;
  animation: fall 4s linear forwards;
  z-index: 2;
}
@keyframes fall {
  0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
  100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
}
#final-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 15vw;
  font-weight: bold;
  color: blue;
  text-transform: uppercase;
  opacity: 0;
  transition: opacity 2s ease;
  z-index: 6;
  pointer-events: none;
}
#surprise-btn {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  padding: 25px 50px;
  font-size: 32px;
  font-weight: bold;
  background: #ff0066;
  color: white;
  border: none;
  border-radius: 20px;
  cursor: pointer;
  opacity: 0;
  transition: opacity 1.5s ease;
  z-index: 20;
  box-shadow: 0 8px 20px rgba(0,0,0,0.4);
  text-transform: uppercase;
}
#surprise-btn:hover {
  background: #ff3388;
  transform: translate(-50%, -50%) scale(1.1);
}
</style>
</head>
<body>

<div id="cake-container">
  <img id="cake" src="https://t4.ftcdn.net/jpg/16/71/84/93/360_F_1671849302_Kd1mOvrFv0rpBHikrMCIOsQpNUJzVxz2.jpg" alt="Birthday Cake">
  <img src="https://purepng.com/public/uploads/large/candle-flame-pmu.png" class="flame" id="flame">
</div>

<button id="blow-btn">Blow</button>

<button id="surprise-btn">Just kidding!<br>Click here ---SURPRISE</button>

<div id="final-text">Happy Bday Ji</div>

<audio id="bg-music" preload="auto" loop>
  <source src="birthday-music.mp3" type="audio/mpeg">
</audio>

<script>
const totalPhotos = 18;
const photos = Array.from({length: totalPhotos}, (_, i) => `photo${i+1}.jpeg`);

const prankYouTubeLink = "https://www.youtube.com/watch?v=xvFZjo5PgG0&autoplay=1";

const cakeContainer = document.getElementById('cake-container');
const flame = document.getElementById('flame');
const blowBtn = document.getElementById('blow-btn');
const surpriseBtn = document.getElementById('surprise-btn');
const music = document.getElementById('bg-music');
const finalText = document.getElementById('final-text');

// Blow button click → open prank in new tab
blowBtn.onclick = function() {
  console.log("Blow clicked - opening prank in new tab");

  flame.style.display = 'none';

  const smoke = document.createElement('div');
  smoke.classList.add('smoke');
  cakeContainer.appendChild(smoke);

  cakeContainer.style.opacity = '0';
  blowBtn.style.opacity = '0';

  window.open(prankYouTubeLink, '_blank');

  setTimeout(() => {
    cakeContainer.style.display = 'none';
    blowBtn.style.display = 'none';
    surpriseBtn.style.opacity = '1';
  }, 1500);
};

// Surprise button → start celebration
surpriseBtn.onclick = function() {
  console.log("Surprise button clicked!");

  surpriseBtn.style.opacity = '0';

  // Confetti
  for (let i = 0; i < 200; i++) {
    const confetti = document.createElement('div');
    confetti.classList.add('confetti');
    confetti.style.background = `hsl(${Math.random()*360}, 90%, 60%)`;
    confetti.style.left = Math.random() * 100 + 'vw';
    confetti.style.top = '-50px';
    confetti.style.animationDelay = Math.random() * 0.6 + 's';
    confetti.style.animationDuration = (3 + Math.random() * 3) + 's';
    document.body.appendChild(confetti);
  }

  // Play music with loop and restart from beginning
  music.currentTime = 0;
  music.loop = true;  // Ensures it keeps playing forever
  music.play().catch(e => console.error("Music failed:", e));

  // Start slideshow
  setTimeout(() => showSlideshow(0), 1000);
};

function showSlideshow(index) {
  if (index >= photos.length) {
    fadeOutPhotosAndShowText();
    return;
  }

  const img = document.createElement('img');
  img.src = photos[index];
  img.classList.add('photo');
  img.onerror = () => console.error("Missing photo:", photos[index]);
  document.body.appendChild(img);

  setTimeout(() => img.style.opacity = '1', 200);

  setTimeout(() => {
    img.style.opacity = '0';
    setTimeout(() => {
      img.remove();
      showSlideshow(index + 1);
    }, 2000);
  }, 2800); // Each photo ~2.8 seconds
}

function fadeOutPhotosAndShowText() {
  document.querySelectorAll('.photo').forEach(p => p.style.opacity = '0');
  
  // Music continues playing even after final text
  setTimeout(() => {
    finalText.style.opacity = '1';
  }, 2200);
}

// Keep music playing if page is reloaded or returned to
window.onload = function() {
  if (cakeContainer.style.opacity === '0' || cakeContainer.style.display === 'none') {
    surpriseBtn.style.opacity = '1';
  }
};
</script>
</body>
</html>